(function(t){function e(e){for(var a,o,i=e[0],c=e[1],l=e[2],u=0,p=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&p.push(s[o][0]),s[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);d&&d(e);while(p.length)p.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],a=!0,i=1;i<r.length;i++){var c=r[i];0!==s[c]&&(a=!1)}a&&(n.splice(e--,1),t=o(o.s=r[0]))}return t}var a={},s={app:0},n=[];function o(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=a,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(r,a,function(e){return t[e]}.bind(null,a));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var d=c;n.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"132a":function(t,e,r){"use strict";var a=r("72a1"),s=r.n(a);s.a},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("v-app",{attrs:{id:"inspire"}},[a("v-navigation-drawer",{attrs:{app:"",absolute:"",temporary:"",src:"https://cdn.vuetifyjs.com/images/backgrounds/bg-2.jpg",width:"300px",dark:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"300",tile:""}},[a("v-list",{attrs:{dense:""}},[a("v-list-item-group",{attrs:{color:"primary"}},[a("v-list-item",[a("v-list-item-avatar",[a("v-img",{attrs:{src:t.currentUserAvatar}})],1),a("v-list-item-content",[a("v-list-item-title",{staticStyle:{color:"white"}},[t._v(t._s(t.currentUserName))])],1)],1),t._l(t.links,(function(e){return a("v-list-item",{key:e.title,attrs:{to:e.url}},[a("v-list-item-icon",[a("v-icon",{domProps:{textContent:t._s(e.icon)}})],1),a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.title)}})],1)],1)})),t.isUserLoggedIn?a("v-list-item",{on:{click:t.onLogout}},[a("v-list-item-icon",[a("v-icon",[t._v("mdi-exit-to-app")])],1),a("v-list-item-content",[a("v-list-item-title",[t._v("Выйти")])],1)],1):t._e()],2)],1)],1),a("v-divider")],1),a("v-app-bar",{attrs:{app:"",color:"rgb(14,117,189)",dark:""}},[a("v-app-bar-nav-icon",{staticClass:"hidden-md-and-up",on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),a("router-link",{attrs:{to:"/"}},[a("v-img",{attrs:{src:r("c581"),height:"40"}})],1),a("v-toolbar-title",[a("router-link",{staticClass:"pointer",attrs:{to:"/",tag:"span"}},[t._v("vue-stas-store.com")])],1),a("div",{staticClass:"userInfoDiv"},[t._v(" "+t._s(t.currentUserInfo)+" ")]),a("v-spacer"),a("v-toolbar-items",{staticClass:"hidden-sm-and-down"},[t._l(t.links,(function(e){return a("v-btn",{key:e.title,attrs:{to:e.url,text:""}},[a("v-icon",{attrs:{left:""}},[t._v(" "+t._s(e.icon)+" ")]),t._v(" "+t._s(e.title)+" ")],1)})),t.isUserLoggedIn?a("v-btn",{attrs:{text:""},on:{click:t.onLogout}},[a("v-icon",{attrs:{left:""}},[t._v("mdi-exit-to-app")]),t._v(" Выйти ")],1):t._e()],2)],1),a("v-content",[a("router-view")],1),t.error?[a("v-snackbar",{attrs:{timeout:t.timeout,"multi-line":"",color:"error",top:"",value:!0},on:{input:t.closeError}},[t._v(" "+t._s(t.error)+" "),a("v-btn",{attrs:{dark:"",text:""},nativeOn:{click:function(e){return t.closeError(e)}}},[t._v("Закрыть")])],1)]:t._e(),a("v-footer",{attrs:{color:"rgb(14,117,189)",app:""}},[a("span",{staticClass:"white--text"},[t._v("© 2011–2020, «Lightxlamp», Inc or its affiliates")])])],2)],1)},n=[],o={props:{source:String},data:function(){return{drawer:null,timeout:5e3}},computed:{error:function(){return this.$store.getters.error},currentUserAvatar:function(){return this.$store.getters.currentUserAvatar},currentUserName:function(){return this.$store.getters.currentUserName},isUserLoggedIn:function(){return this.$store.getters.isUserLoggedIn},links:function(){return this.isUserLoggedIn?[{title:"Заказы",icon:"mdi-bookmark",url:"/orders"},{title:"Новое объявление",icon:"mdi-note",url:"/new"},{title:"Мои объявления",icon:"mdi-clipboard-list",url:"/list"},{title:"Мой аккаунт",icon:"mdi-account",url:"/account"}]:[{title:"Вход",icon:"mdi-lock",url:"/login"},{title:"Регистрация",icon:"mdi-face",url:"/registration"}]},currentUserInfo:function(){return console.log("this.$store.getters.user: ",this.$store.getters.user),null!==this.$store.getters.user?"Здравствуйте, "+this.$store.getters.currentUserName:"No user logged in"}},methods:{closeError:function(){this.$store.dispatch("clearError")},onLogout:function(){this.$store.dispatch("logoutUser"),this.$router.push("/")}}},i=o,c=(r("132a"),r("2877")),l=r("6544"),d=r.n(l),u=r("7496"),p=r("40dc"),v=r("5bc1"),m=r("8336"),f=r("b0af"),g=r("a75b"),h=r("ce7e"),b=r("553a"),x=r("132d"),w=r("adda"),y=r("8860"),V=r("da13"),C=r("8270"),_=r("5d23"),k=r("1baa"),O=r("34c3"),L=r("f774"),U=r("2db4"),j=r("2fa4"),A=r("2a7f"),$=Object(c["a"])(i,s,n,!1,null,null,null),I=$.exports;d()($,{VApp:u["a"],VAppBar:p["a"],VAppBarNavIcon:v["a"],VBtn:m["a"],VCard:f["a"],VContent:g["a"],VDivider:h["a"],VFooter:b["a"],VIcon:x["a"],VImg:w["a"],VList:y["a"],VListItem:V["a"],VListItemAvatar:C["a"],VListItemContent:_["a"],VListItemGroup:k["a"],VListItemIcon:O["a"],VListItemTitle:_["c"],VNavigationDrawer:L["a"],VSnackbar:U["a"],VSpacer:j["a"],VToolbarItems:A["a"],VToolbarTitle:A["b"]});var S=r("f309");a["a"].use(S["a"]);var E=new S["a"]({}),R=r("8c4f"),T=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.loading?r("div",[r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{staticClass:"text-sm-center pt-5",attrs:{xs12:""}},[r("v-progress-circular",{attrs:{size:80,color:"primary",indeterminate:""}})],1)],1)],1)],1):r("div",[r("v-container",{attrs:{fluid:""}},[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-carousel",{attrs:{cycle:"",interval:"4000","show-arrows-on-hover":""}},t._l(t.promoAds,(function(e){return r("v-carousel-item",{key:e.id,attrs:{src:e.imageSrc,contain:""}},[r("div",{staticClass:"car-link"},[r("v-btn",{staticClass:"error",attrs:{to:"/ad/"+e.id}},[t._v(t._s(e.title))])],1)])})),1)],1)],1)],1),r("v-container",{attrs:{"grid-list-lg":""}},[r("v-layout",{attrs:{row:"",wrap:""}},t._l(t.ads,(function(e){return r("v-flex",{key:e.id,attrs:{xs12:"",sm6:"",md4:""}},[r("v-card",{staticClass:"mx-auto pt-5"},[r("v-img",{staticClass:"white--text align-end",attrs:{height:"200px",src:e.imageSrc,contain:""}},[r("v-card-title",[t._v(t._s(e.title))])],1),r("v-card-subtitle",{staticClass:"pb-1 price"},[t._v("$34.99")]),r("v-card-text",{staticClass:"text--primary"},[r("div",[t._v(t._s(e.description))])]),r("v-card-actions",[r("v-btn",{attrs:{text:"",to:"/ad/"+e.id}},[t._v(" Открыть ")]),r("app-buy-modal",{attrs:{ad:e}})],1)],1)],1)})),1)],1)],1)},F=[],P={computed:{promoAds:function(){return this.$store.getters.promoAds},ads:function(){return this.$store.getters.ads},loading:function(){return this.$store.getters.loading}}},D=P,N=(r("b79c"),r("99d9")),B=r("5e66"),M=r("3e35"),z=r("a523"),q=r("0e8f"),G=r("a722"),W=r("490a"),Y=Object(c["a"])(D,T,F,!1,null,"3fe7d6d6",null),J=Y.exports;d()(Y,{VBtn:m["a"],VCard:f["a"],VCardActions:N["a"],VCardSubtitle:N["b"],VCardText:N["c"],VCardTitle:N["d"],VCarousel:B["a"],VCarouselItem:M["a"],VContainer:z["a"],VFlex:q["a"],VImg:w["a"],VLayout:G["a"],VProgressCircular:W["a"]});var K=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{staticClass:"grey lighten-5"},[t.loading?r("v-row",{attrs:{justify:"center"}},[r("v-col",{attrs:{md:"auto"}},[r("v-progress-circular",{attrs:{size:80,color:"primary",indeterminate:""}})],1)],1):r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{attrs:{cols:"12",sm:"6"}},[r("v-img",{attrs:{src:t.ad.imageSrc}})],1),r("v-col",{attrs:{cols:"12",sm:"6"}},[r("v-card-text",{staticClass:"AdDescription",attrs:{outlined:"",tile:""}},[r("h1",{staticClass:"text--primary"},[t._v(t._s(t.ad.title))]),r("p",[t._v(t._s(t.ad.description))])]),r("v-card-actions",[t.isOwner?r("edit-ad-modal",{attrs:{ad:t.ad}}):t._e(),t.isOwner?t._e():r("app-buy-modal",{attrs:{ad:t.ad}})],1)],1)],1)],1)},H=[],Q=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("v-btn",{staticClass:"primary mr-2",on:{click:function(e){t.dialog=!0}}},[t._v("Редактировать")]),r("v-dialog",{attrs:{persistent:"","max-width":"900"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-card",[r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-card-title",[r("h3",{staticClass:"text--primary"},[t._v("Редактировать объявление")])])],1)],1),r("v-divider"),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-card-text",[r("v-text-field",{attrs:{label:"Заголовок",name:"title",type:"text"},model:{value:t.editedTitle,callback:function(e){t.editedTitle=e},expression:"editedTitle"}}),r("v-textarea",{attrs:{label:"Описание",name:"description",type:"text",rows:"14"},model:{value:t.editedDescription,callback:function(e){t.editedDescription=e},expression:"editedDescription"}})],1)],1)],1),r("v-divider"),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-card-actions",[r("v-spacer"),r("v-btn",{staticClass:"success",on:{click:t.onMySave}},[t._v("Сохранить")]),r("v-btn",{attrs:{text:""},on:{click:t.onMyCancel}},[t._v("Отмена")])],1)],1)],1)],1)],1)],1)],1)},X=[],Z=(r("a4d3"),r("e01a"),{props:["ad"],data:function(){return{dialog:!1,editedDescription:this.ad.description,editedTitle:this.ad.title}},methods:{onMyCancel:function(){this.editedDescription=this.ad.description,this.editedTitle=this.ad.title,this.dialog=!1},onMySave:function(){""!==this.editedDescription&&""!==this.editedTitle&&this.$store.dispatch("updateAd",{title:this.editedTitle,description:this.editedDescription,id:this.ad.id}),this.dialog=!1}}}),tt=Z,et=r("169a"),rt=r("8654"),at=r("a844"),st=Object(c["a"])(tt,Q,X,!1,null,null,null),nt=st.exports;d()(st,{VBtn:m["a"],VCard:f["a"],VCardActions:N["a"],VCardText:N["c"],VCardTitle:N["d"],VContainer:z["a"],VDialog:et["a"],VDivider:h["a"],VFlex:q["a"],VLayout:G["a"],VSpacer:j["a"],VTextField:rt["a"],VTextarea:at["a"]});var ot={props:["id"],computed:{ad:function(){var t=this.id;return this.$store.getters.adById(t)},loading:function(){return this.$store.getters.loading},isOwner:function(){return null!==this.$store.getters.user&&this.ad.ownerId===this.$store.getters.user.id}},components:{EditAdModal:nt}},it=ot,ct=(r("c1db"),r("62ad")),lt=r("0fd9"),dt=Object(c["a"])(it,K,H,!1,null,"9b27dc38",null),ut=dt.exports;d()(dt,{VCardActions:N["a"],VCardText:N["c"],VCol:ct["a"],VContainer:z["a"],VImg:w["a"],VProgressCircular:W["a"],VRow:lt["a"]});var pt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",[t.loading?r("v-layout",{attrs:{row:"","justify-center":"",id:"loading"}},[r("div",{staticClass:"ma-12"},[r("v-progress-circular",{attrs:{size:80,color:"primary",indeterminate:""}})],1)]):t.loading||0===t.myAds.length?t.loading||0!==t.myAds.length?t._e():r("v-layout",{attrs:{row:""}},[r("v-flex",{staticClass:"text-xs-center",attrs:{xs12:""}},[r("h2",{staticClass:"text--primary"},[t._v("У вас нет объявлений")])])],1):r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:"",sm10:"",md10:"",lg10:"",xl8:"","offset-sm1":"","offset-md1":"","offset-lg1":"","offset-xl2":""}},[r("h1",{staticClass:"text--secondary mb-3 ml-5"},[t._v("Список ваших объявлений")]),t._l(t.myAds,(function(e){return r("v-card",{key:e.id,staticClass:"elevation-10 mb-5 pl-7 pt-5 pb-5"},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"",sm11:"",md6:"",lg6:""}},[r("v-img",{attrs:{src:e.imageSrc}})],1),r("v-flex",{attrs:{xs11:"",sm12:"",md6:"",lg6:""}},[r("v-card-text",{staticClass:"pr-sm-10 pr-md-10 pr-lg-10"},[r("h2",{staticClass:"text--primary"},[t._v(t._s(e.title))]),r("p",{staticClass:"adDescription pt-3"},[t._v(t._s(e.description))])]),r("v-card-subtitle",{staticClass:"price pa-0 pl-4"},[t._v(" $34.99 ")]),r("v-card-actions",[r("v-spacer"),r("v-btn",{staticClass:"info",attrs:{to:"/ad/"+e.id}},[t._v("Открыть")])],1)],1)],1)],1)}))],2)],1)],1)},vt=[],mt={computed:{myAds:function(){return this.$store.getters.myAds},loading:function(){return this.$store.getters.loading}}},ft=mt,gt=(r("d0e7"),Object(c["a"])(ft,pt,vt,!1,null,"b2bb4592",null)),ht=gt.exports;d()(gt,{VBtn:m["a"],VCard:f["a"],VCardActions:N["a"],VCardSubtitle:N["b"],VCardText:N["c"],VContainer:z["a"],VFlex:q["a"],VImg:w["a"],VLayout:G["a"],VProgressCircular:W["a"],VSpacer:j["a"]});var bt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs10:"",sm8:"",md8:"",lg8:"",xl6:"","offset-xs1":"","offset-sm2":"","offset-md2":"","offset-lg2":"","offset-xl3":""}},[r("h1",{staticClass:"text--secondary mb-3"},[t._v("Добавить объявление")]),r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-text-field",{attrs:{name:"title",label:"Название",type:"text",required:"",rules:[function(t){return!!t||"Название - обязательное поле"}]},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),r("v-textarea",{attrs:{id:"password",name:"desctiption",label:"Описание",type:"text",multiline:"",rules:[function(t){return!!t||"Описание - обязательное поле"}]},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-btn",{staticClass:"ma-2 white--text",attrs:{color:"blue-grey"},on:{click:t.triggerUpload}},[t._v(" Загрузить изображение "),r("v-icon",{attrs:{right:"",dark:""}},[t._v("mdi-cloud-upload")])],1),r("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:t.onFileChange}})],1)],1),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[t.imageSrc?r("img",{staticClass:"ma-2",attrs:{src:t.imageSrc,height:"300px",alt:""}}):t._e()])],1),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-switch",{staticClass:"pl-2",attrs:{label:"Добавить в промо?"},model:{value:t.promo,callback:function(e){t.promo=e},expression:"promo"}})],1)],1),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-spacer"),r("v-btn",{staticClass:"success ml-2",attrs:{loading:t.loading,disabled:!t.valid||!t.image||t.loading},on:{click:t.createAd}},[t._v("Создать объявление")])],1)],1)],1)],1)],1)},xt=[],wt={data:function(){return{title:"",promo:!1,description:"",valid:!1,image:!1,imageSrc:""}},computed:{loading:function(){return this.$store.getters.loading}},methods:{createAd:function(){var t=this;if(this.$refs.form.validate()&&this.image){var e={title:this.title,description:this.description,promo:this.promo,image:this.image};this.$store.dispatch("createAd",e).then((function(){t.$router.push("/list")})).catch((function(){}))}},triggerUpload:function(){this.$refs.fileInput.click()},onFileChange:function(t){var e=this,r=t.target.files[0],a=new FileReader;a.onload=function(){e.imageSrc=a.result},a.readAsDataURL(r),this.image=r}}},yt=wt,Vt=r("4bd4"),Ct=r("b73d"),_t=Object(c["a"])(yt,bt,xt,!1,null,"4916d97b",null),kt=_t.exports;d()(_t,{VBtn:m["a"],VContainer:z["a"],VFlex:q["a"],VForm:Vt["a"],VIcon:x["a"],VLayout:G["a"],VSpacer:j["a"],VSwitch:Ct["a"],VTextField:rt["a"],VTextarea:at["a"]});var Ot=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[r("v-row",{attrs:{align:"center",justify:"center"}},[r("v-col",{attrs:{cols:"12",sm:"8",md:"4"}},[r("v-card",{staticClass:"elevation-12"},[r("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[r("v-toolbar-title",[t._v("Форма входа")])],1),r("v-card-text",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-text-field",{attrs:{label:"Email",name:"email","prepend-icon":"mdi-account",type:"email",rules:t.emailRules},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),r("v-text-field",{attrs:{id:"password",label:"Пароль",name:"password","prepend-icon":"mdi-lock",type:"password",counter:6,rules:t.passwordRules},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{disabled:!t.valid||t.loading,loading:t.loading,color:"primary"},on:{click:t.onSubmit}},[t._v(" Войти ")])],1)],1)],1)],1)],1)},Lt=[],Ut={data:function(){return{valid:!1,email:"",password:"",emailRules:[function(t){return!!t||"Электронный адрес - обязательное поле"},function(t){return/.+@.+/.test(t)||"Некоректный формат адреса"}],passwordRules:[function(t){return!!t||"Пароль - обязательное поле"},function(t){return t.length>=6||"Пароль должен быть не меньше 6ти символов"}]}},computed:{loading:function(){return this.$store.getters.loading}},methods:{onSubmit:function(){var t=this;if(this.$refs.form.validate()){var e={email:this.email,password:this.password};this.$store.dispatch("loginUser",e).then((function(){t.$router.push("/")})).catch((function(){}))}}},created:function(){this.$route.query["loginError"]&&this.$store.dispatch("setError","Please log in to access this page.")}},jt=Ut,At=r("71d9"),$t=Object(c["a"])(jt,Ot,Lt,!1,null,"49bf6a3e",null),It=$t.exports;d()($t,{VBtn:m["a"],VCard:f["a"],VCardActions:N["a"],VCardText:N["c"],VCol:ct["a"],VContainer:z["a"],VForm:Vt["a"],VRow:lt["a"],VSpacer:j["a"],VTextField:rt["a"],VToolbar:At["a"],VToolbarTitle:A["b"]});var St=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[r("v-row",{attrs:{align:"center",justify:"center"}},[r("v-col",{attrs:{cols:"12",sm:"8",md:"4"}},[r("v-card",{staticClass:"elevation-12"},[r("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[r("v-toolbar-title",[t._v("Форма регистрации")])],1),r("v-card-text",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-text-field",{attrs:{label:"Email",name:"email","prepend-icon":"mdi-account",type:"email",rules:t.emailRules},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),r("v-text-field",{attrs:{id:"password",label:"Пароль",name:"password","prepend-icon":"mdi-lock",type:"password",counter:6,rules:t.passwordRules},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),r("v-text-field",{attrs:{id:"confirm-password",label:"Пароль повторно",name:"confirm-password","prepend-icon":"mdi-lock",type:"password",counter:6,rules:t.confirmPasswordRules},model:{value:t.confirmPassword,callback:function(e){t.confirmPassword=e},expression:"confirmPassword"}})],1)],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{disabled:!t.valid||!0===t.loading,loading:t.loading,color:"primary"},on:{click:t.onSubmit}},[t._v(" Зарегестрироваться ")])],1)],1)],1)],1)],1)},Et=[],Rt={data:function(){var t=this;return{valid:!1,email:"",password:"",confirmPassword:"",emailRules:[function(t){return!!t||"Электронный адрес - обязательное поле"},function(t){return/.+@.+/.test(t)||"Некоректный формат адреса"}],passwordRules:[function(t){return!!t||"Пароль - обязательное поле"},function(t){return t.length>=6||"Пароль должен быть не меньше 6ти символов"}],confirmPasswordRules:[function(t){return!!t||"Подтверждающий пароль - обязательное поле"},function(e){return e===t.password||"Пароли должны совпадать"}]}},computed:{loading:function(){return this.$store.getters.loading}},methods:{onSubmit:function(){var t=this;if(this.$refs.form.validate()){var e={email:this.email,password:this.password};this.$store.dispatch("registerUser",e).then((function(){t.$router.push("/")})).catch((function(){}))}}}},Tt=Rt,Ft=Object(c["a"])(Tt,St,Et,!1,null,"e27080a6",null),Pt=Ft.exports;d()(Ft,{VBtn:m["a"],VCard:f["a"],VCardActions:N["a"],VCardText:N["c"],VCol:ct["a"],VContainer:z["a"],VForm:Vt["a"],VRow:lt["a"],VSpacer:j["a"],VTextField:rt["a"],VToolbar:At["a"],VToolbarTitle:A["b"]});var Dt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",[t.loading?r("v-layout",{attrs:{row:"","justify-center":"",id:"loading"}},[r("div",{staticClass:"ma-12"},[r("v-progress-circular",{attrs:{size:80,color:"primary",indeterminate:""}})],1)]):t.loading||0===t.orders.length?r("v-layout",{attrs:{row:""}},[r("v-flex",{staticClass:"text-xl-start",attrs:{xs12:""}},[r("h1",{staticClass:"text--secondary"},[t._v("У Вас нет заказов")])])],1):r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[r("h1",{staticClass:"text--secondary mb-3"},[t._v("Заказы")]),r("v-list",{attrs:{subheader:"","two-line":"",flat:""}},[r("v-list-item-group",{attrs:{multiple:""}},t._l(t.orders,(function(e){return r("v-list-item",{key:e.id},[[r("v-list-item-action",[r("v-checkbox",{attrs:{color:"success","input-value":e.done},on:{change:function(r){return t.markDone(e)}}})],1),r("v-list-item-content",[r("v-list-item-title",[t._v(t._s(e.name))]),r("v-list-item-subtitle",[t._v(t._s(e.phone))])],1),r("v-list-item-action",[r("v-btn",{staticClass:"primary",attrs:{to:"/ad/"+e.adId}},[t._v("Открыть")])],1)]],2)})),1)],1)],1)],1)],1)},Nt=[],Bt={methods:{markDone:function(t){this.$store.dispatch("markOrderAsDone",t.id).then((function(){t.done=!0})).catch((function(){}))}},computed:{loading:function(){return this.$store.getters.loading},orders:function(){return this.$store.getters.allOrders}},created:function(){this.$store.dispatch("fetchOrders")}},Mt=Bt,zt=r("ac7c"),qt=r("1800"),Gt=Object(c["a"])(Mt,Dt,Nt,!1,null,"7b1151ca",null),Wt=Gt.exports;d()(Gt,{VBtn:m["a"],VCheckbox:zt["a"],VContainer:z["a"],VFlex:q["a"],VLayout:G["a"],VList:y["a"],VListItem:V["a"],VListItemAction:qt["a"],VListItemContent:_["a"],VListItemGroup:k["a"],VListItemSubtitle:_["b"],VListItemTitle:_["c"],VProgressCircular:W["a"]});var Yt=r("2f62"),Jt=(r("99af"),r("4de4"),r("7db0"),r("4160"),r("baa5"),r("fb6a"),r("b0c0"),r("e439"),r("dbb4"),r("b64b"),r("d3b7"),r("159b"),r("2fa7")),Kt=(r("96cf"),r("9f12")),Ht=r("8aa5");function Qt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function Xt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Qt(r,!0).forEach((function(e){Object(Jt["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qt(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Zt=function t(e,r,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;Object(Kt["a"])(this,t),this.title=e,this.description=r,this.ownerId=a,this.imageSrc=s,this.promo=n,this.id=o},te={state:{ads:[]},actions:{createAd:function(t,e){var r,a,s,n,o,i,c;return regeneratorRuntime.async((function(l){while(1)switch(l.prev=l.next){case 0:return r=t.commit,a=t.getters,console.log("CreateAd Action is called"),r("clearError"),r("setLoading",!0),console.log("= adObjFromForm: ",e),s=e.image,console.log("= Image: ",s),l.prev=7,n=new Zt(e.title,e.description,a.user.id,e.imageSrc,e.promo),console.log("= NewAd: ",n),l.next=12,regeneratorRuntime.awrap(Ht["database"]().ref("ads").push(n));case 12:return o=l.sent,console.log("fireBaseAdValue: ",o),i=s.name.slice(s.name.lastIndexOf(".")),console.log("ImageExtension: ",i),l.next=18,regeneratorRuntime.awrap(Ht["storage"]().ref("ads/".concat(o.key,".").concat(i)).put(s));case 18:c=l.sent,console.log("= fileData: ",c),c.ref.getDownloadURL().then((function(t){Ht["database"]().ref("ads").child(o.key).update({imageSrc:t}),r("setLoading",!1),r("createAd",Xt({},n,{imageSrc:t,id:o.key})),console.log(t)})).then(),l.next=30;break;case 23:throw l.prev=23,l.t0=l["catch"](7),r("setError".error.message),console.log(l.t0.message),r("setLoading",!1),alert("Create ad Error"),l.t0;case 30:case"end":return l.stop()}}),null,null,[[7,23]])},fetchAds:function(t){var e,r,a,s;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:return e=t.commit,e("clearError"),e("setLoading",!0),r=[],n.prev=4,n.next=7,regeneratorRuntime.awrap(Ht["database"]().ref("ads").once("value"));case 7:a=n.sent,console.log(a.val()),s=a.val(),null!=s&&Object.keys(s).forEach((function(t){var e=s[t];r.push(new Zt(e.title,e.description,e.ownerId,e.imageSrc,e.promo,t))})),e("loadAds",r),e("setLoading",!1),n.next=20;break;case 15:throw n.prev=15,n.t0=n["catch"](4),e("setError",n.t0.message),e("setLoading",!1),n.t0;case 20:case"end":return n.stop()}}),null,null,[[4,15]])},updateAd:function(t,e){var r,a,s,n;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:return r=t.commit,a=e.title,s=e.description,n=e.id,r("clearError"),r("setLoading",!0),console.log("UpdateAd action is called"),o.prev=5,o.next=8,regeneratorRuntime.awrap(Ht["database"]().ref("ads").child(n).update({title:a,description:s}));case 8:r("updateAd",{title:a,description:s,id:n}),r("setLoading",!1),o.next=17;break;case 12:throw o.prev=12,o.t0=o["catch"](5),r("setError",o.t0.message),r("setLoading",!1),o.t0;case 17:case"end":return o.stop()}}),null,null,[[5,12]])}},mutations:{createAd:function(t,e){console.log("CreateAd mutation is called"),console.log(t),console.log("adObjFromFormAndFireBase:",e),t.ads.push(e)},loadAds:function(t,e){t.ads=e},updateAd:function(t,e){var r=e.title,a=e.description,s=e.id;console.log("UpdateAd mutation is called"),console.log("Id",s);var n=null;if(void 0!==t.ads)for(var o=0;o<t.ads.length;o++)if(t.ads[o].id===s){n=t.ads[o];break}console.log("Ad to edit found",n),n.title=r,n.description=a}},getters:{ads:function(t){return t.ads},promoAds:function(t){return t.ads.filter((function(t){return!0===t.promo}))},myAds:function(t,e){return console.log("state ads",t.ads),console.log("getters user id",e.user.id),t.ads.filter((function(t){return t.ownerId===e.user.id}))},adById:function(t){return function(e){return t.ads.find((function(t){return t.id===e}))}}}},ee=function t(e){Object(Kt["a"])(this,t),this.id=e},re={state:{user:null,firebaseUserObject:null},mutations:{setUser:function(t,e){t.user=e},setFireBaseUserObject:function(t,e){t.firebaseUserObject=e}},actions:{registerUser:function(t,e){var r,a,s,n;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:return r=t.commit,a=e.email,s=e.password,r("clearError"),r("setLoading",!0),o.prev=4,o.next=7,regeneratorRuntime.awrap(Ht["auth"]().createUserWithEmailAndPassword(a,s));case 7:n=o.sent,r("setUser",new ee(n.uid)),r("setLoading",!1),o.next=17;break;case 12:throw o.prev=12,o.t0=o["catch"](4),r("setLoading",!1),r("setError",o.t0.message),o.t0;case 17:case"end":return o.stop()}}),null,null,[[4,12]])},loginUser:function(t,e){var r,a,s,n;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:return r=t.commit,a=e.email,s=e.password,r("clearError"),r("setLoading",!0),o.prev=4,o.next=7,regeneratorRuntime.awrap(Ht["auth"]().signInWithEmailAndPassword(a,s));case 7:n=o.sent,console.log("userFromFireBase",n),console.log("userFromFireBase.UID",n.user.uid),console.log("userFromFireBase.Name",n.user.displayName),r("setFireBaseUserObject",n),r("setUser",new ee(n.user.uid)),r("setLoading",!1),o.next=21;break;case 16:throw o.prev=16,o.t0=o["catch"](4),r("setLoading",!1),r("setError",o.t0.message),o.t0;case 21:case"end":return o.stop()}}),null,null,[[4,16]])},updateUser:function(t,e){var r,a,s,n;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:return r=t.commit,a=e.userName,s=e.avatarSrc,r("clearError"),r("setLoading",!0),console.log("userName",a),console.log("avatarSrc",s),o.prev=6,n=this.firebaseUserObject.user,console.log("Before: this.firebaseUserObject.user.displayName",n.displayName),console.log("Before: this.firebaseUserObject.user.photoURL",n.photoURL),o.next=12,regeneratorRuntime.awrap(n.updateProfile({displayName:a,photoURL:s}));case 12:console.log("After: this.firebaseUserObject.user.displayName",n.displayName),console.log("After: this.firebaseUserObject.user.photoURL",n.photoURL),r("setLoading",!1),o.next=20;break;case 17:throw o.prev=17,o.t0=o["catch"](6),o.t0;case 20:case"end":return o.stop()}}),null,this,[[6,17]])},autoLoginUser:function(t,e){var r=t.commit;r("setUser",new ee(e.uid))},logoutUser:function(t){var e=t.commit;Ht["auth"]().signOut(),e("setUser",null),e("setFireBaseUserObject",null)}},getters:{user:function(t){return t.user},isUserLoggedIn:function(t){return null!==t.user},firebaseUserObject:function(t){return t.firebaseUserObject},currentUserAvatar:function(t){return null!==t.firebaseUserObject?t.firebaseUserObject.user.photoURL:"http://bootdey.com/img/Content/avatar/avatar7.png"},currentUserName:function(t){return null!==t.firebaseUserObject?t.firebaseUserObject.user.displayName:"Unauthorized user"}}},ae={state:{loading:!1,error:null},actions:{setLoading:function(t,e){var r=t.commit;r("setLoading",e)},setError:function(t,e){var r=t.commit;r("setError",e)},clearError:function(t){var e=t.commit;e("clearError")}},mutations:{setLoading:function(t,e){t.loading=e},setError:function(t,e){t.error=e},clearError:function(t){t.error=null}},getters:{loading:function(t){return t.loading},error:function(t){return t.error}}},se=function t(e,r,a){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Object(Kt["a"])(this,t),this.name=e,this.phone=r,this.adId=a,this.done=s,this.id=n},ne={state:{orders:[]},actions:{createOrder:function(t,e){var r,a,s,n,o,i;return regeneratorRuntime.async((function(c){while(1)switch(c.prev=c.next){case 0:return r=t.commit,a=e.name,s=e.phone,n=e.adId,o=e.ownerId,i=new se(a,s,n),console.log("Order",i),r("clearError"),c.prev=5,c.next=8,regeneratorRuntime.awrap(Ht["database"]().ref("/users/".concat(o,"/orders")).push(i));case 8:c.next=13;break;case 10:c.prev=10,c.t0=c["catch"](5),r("setError",c.t0.message);case 13:case"end":return c.stop()}}),null,null,[[5,10]])},fetchOrders:function(t){var e,r,a,s,n;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:return e=t.commit,r=t.getters,e("setLoading",!0),e("clearError"),a=[],o.prev=4,o.next=7,regeneratorRuntime.awrap(Ht["database"]().ref("/users/".concat(r.user.id,"/orders")).once("value"));case 7:s=o.sent,n=s.val(),null!=n&&(console.log("++++ Before object keys",n),Object.keys(n).forEach((function(t){var e=n[t];a.push(new se(e.name,e.phone,e.adId,e.done,t))}))),e("loadOrders",a),e("setLoading",!1),o.next=18;break;case 14:o.prev=14,o.t0=o["catch"](4),e("setLoading",!1),e("setError",o.t0.message);case 18:case"end":return o.stop()}}),null,null,[[4,14]])},markOrderAsDone:function(t,e){var r,a;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return r=t.commit,a=t.getters,r("clearError"),s.prev=2,s.next=5,regeneratorRuntime.awrap(Ht["database"]().ref("/users/".concat(a.user.id,"/orders")).child(e).update({done:!0}));case 5:s.next=11;break;case 7:throw s.prev=7,s.t0=s["catch"](2),r("setError",s.t0.message),s.t0;case 11:case"end":return s.stop()}}),null,null,[[2,7]])}},mutations:{loadOrders:function(t,e){t.orders=e}},getters:{completedOrders:function(t){return t.orders.filter((function(t){return t.done}))},incompliteOrders:function(t){return t.orders.filter((function(t){return!t.done}))},allOrders:function(t,e){return e.incompliteOrders.concat(e.completedOrders)}}};a["a"].use(Yt["a"]);var oe=new Yt["a"].Store({modules:{ads:te,user:re,shared:ae,orders:ne}}),ie=function(t,e,r){oe.getters.user?r():r("/login?loginError=true")},ce=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:"",sm4:"","offset-sm4":""}},[r("h1",{staticClass:"text--secondary mb-3"},[t._v("Аккаунт")]),r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-text-field",{attrs:{name:"userName",label:"Имя",type:"text",required:"",rules:[function(t){return t&&t.length<=15||"Извините. Имя не должно превышать 15 символов"}]},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}})],1),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-btn",{staticClass:"ma-2 white--text",attrs:{color:"blue-grey"},on:{click:t.triggerUpload}},[t._v(" Загрузить новый аватар "),r("v-icon",{attrs:{right:"",dark:""}},[t._v("mdi-cloud-upload")])],1),r("v-btn",{staticClass:"ma-2 success",attrs:{loading:t.loading,disabled:!t.valid||!t.avatarSrc||t.loading},on:{click:t.updateUser}},[t._v("Сохранить изменения")]),r("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:t.onFileChange}})],1)],1),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[t.avatarSrc?r("img",{staticClass:"ma-2",attrs:{src:t.avatarSrc,height:"300px",alt:""}}):t._e()])],1)],1)],1)],1)},le=[],de={data:function(){return{valid:!1,avatarSrc:!1,userName:this.$store.getters.currentUserName}},mounted:function(){},computed:{loading:function(){return this.$store.getters.loading},currentUserName:function(){return this.$store.getters.firebaseUserObject.user.displayName}},methods:{updateUser:function(){if(this.$refs.form.validate()&&this.avatarSrc){var t={userName:this.userName,avatarSrc:"https://www.w3schools.com/howto/img_avatar.png"};this.$store.dispatch("updateUser",t).then((function(){alert("Аккаунт обновлен")})).catch((function(){}))}},triggerUpload:function(){this.$refs.fileInput.click()},onFileChange:function(t){var e=this,r=t.target.files[0],a=new FileReader;a.onload=function(){e.avatarSrc=a.result},a.readAsDataURL(r),this.avatarSrc=r}}},ue=de,pe=Object(c["a"])(ue,ce,le,!1,null,"b7d15d1a",null),ve=pe.exports;d()(pe,{VBtn:m["a"],VContainer:z["a"],VFlex:q["a"],VForm:Vt["a"],VIcon:x["a"],VLayout:G["a"],VTextField:rt["a"]}),a["a"].use(R["a"]);var me=new R["a"]({routes:[{path:"",name:"Home",component:J},{path:"/ad/:id",props:!0,name:"Ad",component:ut},{path:"/list",name:"AdList",component:ht,beforeEnter:ie},{path:"/new",name:"NewAd",component:kt,beforeEnter:ie},{path:"/login",name:"Login",component:It},{path:"/registration",name:"Registration",component:Pt},{path:"/orders",name:"Orders",component:Wt,beforeEnter:ie},{path:"/account",name:"Account",component:ve,beforeEnter:ie}],mode:"history"}),fe=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("v-btn",{staticClass:"primary mr-2",on:{click:function(e){t.dialog=!0}}},[t._v("Купить")]),r("v-dialog",{attrs:{persistent:"","max-width":"400"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-card",[r("v-container",[r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-card-title",{staticClass:"text--primary"},[t._v(" Вы хотите купить этот товар? ")])],1)],1),r("v-divider"),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-card-text",[r("v-text-field",{attrs:{name:"name",label:"Your name",type:"text"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),r("v-text-field",{attrs:{name:"phone",label:"Your phone",type:"text"},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1)],1)],1),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-card-actions",[r("v-spacer"),r("v-btn",{staticClass:"success",attrs:{"aria-disabled":t.localLoading,loading:t.localLoading},on:{click:t.onMyBuy}},[t._v("Купить")]),r("v-btn",{attrs:{"aria-disabled":t.localLoading,text:""},on:{click:t.onMyCancel}},[t._v("Отмена")])],1)],1)],1)],1)],1)],1)],1)},ge=[],he={props:["ad"],data:function(){return{dialog:!1,name:"",phone:"",localLoading:!1}},methods:{onMyCancel:function(){this.name="",this.phone="",this.dialog=!1},onMyBuy:function(){var t=this;""!==this.name&&""!==this.phone&&(this.localLoading=!0,this.$store.dispatch("createOrder",{name:this.name,phone:this.phone,adId:this.ad.id,ownerId:this.ad.ownerId}).finally((function(){t.name="",t.phone="",t.localLoading=!1,t.dialog=!1})))}}},be=he,xe=Object(c["a"])(be,fe,ge,!1,null,null,null),we=xe.exports;d()(xe,{VBtn:m["a"],VCard:f["a"],VCardActions:N["a"],VCardText:N["c"],VCardTitle:N["d"],VContainer:z["a"],VDialog:et["a"],VDivider:h["a"],VFlex:q["a"],VLayout:G["a"],VSpacer:j["a"],VTextField:rt["a"]});var ye=r("d622"),Ve=r.n(ye);a["a"].config.productionTip=!0,a["a"].component("app-buy-modal",we),a["a"].use(E),new a["a"]({router:me,store:oe,vuetify:E,created:function(){var t=this;Ht["initializeApp"](Ve.a),Ht["auth"]().onAuthStateChanged((function(e){e&&t.$store.dispatch("autoLoginUser",e)})),this.$store.dispatch("fetchAds")},render:function(t){return t(I)}}).$mount("#app")},"6d2f":function(t,e,r){},"72a1":function(t,e,r){},b79c:function(t,e,r){"use strict";var a=r("6d2f"),s=r.n(a);s.a},c1db:function(t,e,r){"use strict";var a=r("dcf7"),s=r.n(a);s.a},c581:function(t,e,r){t.exports=r.p+"img/my_vss_logo_1.b902ec46.png"},d0e7:function(t,e,r){"use strict";var a=r("d66b"),s=r.n(a);s.a},d622:function(t,e){t.exports={apiKey:"AIzaSyC-_fL99SRDOwRlcAvoDZsM58d2jTlBbNM",authDomain:"vue-ad-project-stas.firebaseapp.com",databaseURL:"https://vue-ad-project-stas.firebaseio.com",projectId:"vue-ad-project-stas",storageBucket:"vue-ad-project-stas.appspot.com",messagingSenderId:"83442067408",appId:"1:83442067408:web:5d9bc204b127dbe08c7bd5",measurementId:"G-8WP2EQKSYX"}},d66b:function(t,e,r){},dcf7:function(t,e,r){}});
//# sourceMappingURL=app.0303d0f0.js.map